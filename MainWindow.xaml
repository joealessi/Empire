<Window x:Class="EmpireGame.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:EmpireGame"
        Title="Empire Game" Height="900" Width="1600"
        WindowState="Maximized"
        Background="#1a1a2e">

    <Window.Resources>
        <local:MessageTypeToColorConverter x:Key="MessageTypeToColorConverter"/>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250" MinWidth="150" MaxWidth="500"/>
            <ColumnDefinition Width="5"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="300"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT COLUMN: MESSAGE LOG -->
        <Border Grid.Column="0" Background="#16213e" BorderBrush="#0f3460" BorderThickness="0,0,2,0" Padding="5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="5">
                    <TextBlock Text="Message Log" FontSize="16" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                    <TextBlock x:Name="MessageCountText" Text="[0]" FontSize="14" Foreground="Gray" Margin="5,0,0,0" VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5,5,5,10">
                    <TextBlock Text="Text Size:" FontSize="12" Foreground="White" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <Button x:Name="DecreaseTextSizeButton" Content="-" Width="25" Height="25" Click="DecreaseTextSizeButton_Click" FontWeight="Bold"/>
                    <TextBlock x:Name="MessageTextSizeDisplay" Text="12" FontSize="12" Foreground="White" Width="30" TextAlignment="Center" VerticalAlignment="Center" Margin="5,0"/>
                    <Button x:Name="IncreaseTextSizeButton" Content="+" Width="25" Height="25" Click="IncreaseTextSizeButton_Click" FontWeight="Bold"/>
                </StackPanel>

                <ScrollViewer Grid.Row="2" x:Name="MessageScrollViewer" VerticalScrollBarVisibility="Auto">
                    <ItemsControl x:Name="MessageLogItems">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Text}" 
                                         Foreground="{Binding Type, Converter={StaticResource MessageTypeToColorConverter}}"
                                         TextWrapping="Wrap" 
                                         Margin="2"
                                         FontSize="12"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- GRID SPLITTER -->
        <GridSplitter Grid.Column="1" 
                     HorizontalAlignment="Stretch" 
                     VerticalAlignment="Stretch"
                     Background="#0f3460"
                     ShowsPreview="True"/>

        <!-- CENTER COLUMN: MAP AREA -->
        <Grid Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Top Info Bar -->
            <Border Grid.Row="0" Background="#16213e" BorderBrush="#0f3460" BorderThickness="0,0,0,2" Padding="10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <TextBlock x:Name="TurnNumberText" Text="Turn 1" FontSize="16" FontWeight="Bold" Foreground="White" Margin="0,0,20,0"/>
                        <TextBlock x:Name="CurrentPlayerText" Text="Player 0" FontSize="16" Foreground="LightBlue" Margin="0,0,20,0"/>

                        <!-- Gold -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,15,0">
                            <Image Width="20" Height="20" Margin="0,0,5,0" Source="/Resources/gold_16.png" VerticalAlignment="Center"/>
                            <TextBlock x:Name="GoldText" Text="0" FontSize="14" Foreground="Gold" FontWeight="Bold" Margin="0,0,3,0" VerticalAlignment="Center"/>
                            <TextBlock x:Name="GoldIncomeText" Text="(+0)" FontSize="12" Foreground="LightGreen" VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- Steel -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,15,0">
                            <Image Width="20" Height="20" Margin="0,0,5,0" Source="/Resources/steel_16.png" VerticalAlignment="Center"/>
                            <TextBlock x:Name="SteelText" Text="0" FontSize="14" Foreground="Silver" FontWeight="Bold" Margin="0,0,3,0" VerticalAlignment="Center"/>
                            <TextBlock x:Name="SteelIncomeText" Text="(+0)" FontSize="12" Foreground="LightGreen" VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- Oil -->
                        <StackPanel Orientation="Horizontal">
                            <Image Width="20" Height="20" Margin="0,0,5,0" Source="/Resources/oil_16.png" VerticalAlignment="Center"/>
                            <TextBlock x:Name="OilText" Text="0" FontSize="14" Foreground="Orange" FontWeight="Bold" Margin="0,0,3,0" VerticalAlignment="Center"/>
                            <TextBlock x:Name="OilIncomeText" Text="(+0)" FontSize="12" Foreground="LightGreen" VerticalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button x:Name="ZoomOutButton" Content="-" Width="30" Height="30" Click="ZoomOutButton_Click" Margin="0,0,5,0"/>
                        <TextBlock x:Name="ZoomLevelText" Text="32px" FontSize="14" Foreground="White" VerticalAlignment="Center" Margin="5,0"/>
                        <Button x:Name="ZoomInButton" Content="+" Width="30" Height="30" Click="ZoomInButton_Click" Margin="5,0,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>
            <!-- Map ScrollViewer -->
            <ScrollViewer Grid.Row="1" 
                         HorizontalScrollBarVisibility="Auto" 
                         VerticalScrollBarVisibility="Auto">
                <Canvas x:Name="MapCanvas" Background="#0a0e27" 
                       MouseLeftButtonDown="MapCanvas_MouseLeftButtonDown"
                       MouseRightButtonDown="MapCanvas_MouseRightButtonDown"
                       MouseMove="MapCanvas_MouseMove"/>
            </ScrollViewer>

            <!-- AI Thinking Overlay -->
            <Border Grid.Row="1" x:Name="AIThinkingPanel" Visibility="Collapsed" 
                   Background="#AA000000" HorizontalAlignment="Center" VerticalAlignment="Center"
                   Padding="30" CornerRadius="10">
                <StackPanel>
                    <TextBlock Text="🤖" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                    <TextBlock x:Name="AIStatusText" Text="AI is thinking..." FontSize="18" Foreground="White" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Bomber Mission Panel -->
            <Border Grid.Row="1" x:Name="BomberMissionPanel" Visibility="Collapsed"
                   Background="#DD16213e" BorderBrush="Orange" BorderThickness="3"
                   HorizontalAlignment="Left" VerticalAlignment="Top" Margin="20"
                   Padding="15" CornerRadius="5">
                <StackPanel Width="250">
                    <TextBlock Text="🎯 BOMBING MISSION" FontSize="16" FontWeight="Bold" Foreground="Orange" Margin="0,0,0,10"/>
                    <TextBlock x:Name="BomberRangeText" Text="Range: 0 tiles" Foreground="White" Margin="0,0,0,10"/>
                    <TextBlock Text="Available Escorts:" Foreground="White" Margin="0,0,0,5"/>
                    <ListBox x:Name="AvailableEscortsList" Height="100" Margin="0,0,0,10" SelectionMode="Multiple"/>
                    <CheckBox x:Name="IncludeTankerCheckbox" Content="Include Tanker" Foreground="White" Margin="0,0,0,5"/>
                    <TextBlock x:Name="AvailableTankerText" Text="No tanker available" Foreground="Gray" Margin="0,0,0,10"/>
                    <TextBlock Text="Click target on map" Foreground="Yellow" Margin="0,0,0,10"/>
                    <Button Content="Cancel Mission" Click="CancelMissionButton_Click"/>
                </StackPanel>
            </Border>

            <!-- Patrol Setup Panel -->
            <Border Grid.Row="1" x:Name="PatrolSetupPanel" Visibility="Collapsed"
                   Background="#DD16213e" BorderBrush="Cyan" BorderThickness="3"
                   HorizontalAlignment="Left" VerticalAlignment="Top" Margin="20"
                   Padding="15" CornerRadius="5">
                <StackPanel Width="250">
                    <TextBlock Text="🔄 PATROL SETUP" FontSize="16" FontWeight="Bold" Foreground="Cyan" Margin="0,0,0,10"/>
                    <TextBlock x:Name="PatrolInstructionsText" Text="Click up to 2 waypoints on map" Foreground="White" TextWrapping="Wrap" Margin="0,0,0,10"/>
                    <TextBlock Text="Waypoints:" Foreground="White" Margin="0,0,0,5"/>
                    <ListBox x:Name="PatrolWaypointsList" Height="60" Margin="0,0,0,10"/>
                    <Button Content="Clear Last Waypoint" Click="ClearLastWaypointButton_Click" Margin="0,0,0,5"/>
                    <Button Content="Start Patrol" Click="StartPatrolButton_Click" Margin="0,0,0,5"/>
                    <Button Content="Cancel" Click="CancelPatrolButton_Click"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- RIGHT COLUMN: UNIT/STRUCTURE INFO -->
        <ScrollViewer Grid.Column="3" VerticalScrollBarVisibility="Auto" Background="#16213e">
            <StackPanel Margin="10">
                <!-- Unit Info Panel -->
                <Border x:Name="UnitInfoPanel" Visibility="Collapsed" Background="#1e2a3a" BorderBrush="#0f3460" BorderThickness="2" Padding="10" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock x:Name="UnitNameText" Text="Unit Name" FontSize="18" FontWeight="Bold" Foreground="White" Margin="0,0,0,5"/>
                        <TextBlock x:Name="UnitStatsText" Text="Stats" Foreground="LightGray" Margin="0,0,0,10"/>

                        <!-- Life Bar -->
                        <TextBlock Text="Life:" Foreground="White" Margin="0,0,0,2"/>
                        <Grid Margin="0,0,0,10">
                            <ProgressBar x:Name="LifeProgressBar" Height="20" Minimum="0" Maximum="100"/>
                            <TextBlock x:Name="LifeProgressText" Text="0/0" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold"/>
                        </Grid>

                        <!-- Movement Bar -->
                        <TextBlock Text="Movement:" Foreground="White" Margin="0,0,0,2"/>
                        <Grid Margin="0,0,0,10">
                            <ProgressBar x:Name="MovementProgressBar" Height="20" Minimum="0" Maximum="100"/>
                            <TextBlock x:Name="MovementProgressText" Text="0/0" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold"/>
                        </Grid>

                        <!-- Fuel Gauge (Air Units) -->
                        <StackPanel x:Name="FuelGaugePanel" Visibility="Collapsed" Margin="0,0,0,10">
                            <TextBlock Text="Fuel:" Foreground="White" Margin="0,0,0,2"/>
                            <Grid Margin="0,0,0,5">
                                <ProgressBar x:Name="FuelProgressBar" Height="20" Minimum="0" Maximum="100"/>
                                <TextBlock x:Name="FuelProgressText" Text="0/0" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold"/>
                            </Grid>
                            <TextBlock x:Name="FuelDistanceText" Text="Distance to base: --" Foreground="Cyan" FontSize="11"/>
                            <TextBlock x:Name="FuelWarningText" Text="" Foreground="Red" FontWeight="Bold" TextWrapping="Wrap"/>
                        </StackPanel>

                        <!-- Submarine Panel -->
                        <StackPanel x:Name="SubmarinePanel" Visibility="Collapsed" Margin="0,0,0,10">
                            <TextBlock x:Name="SubmarineStatusText" Text="Status" Foreground="Cyan" FontWeight="Bold"/>
                        </StackPanel>

                        <!-- Carrier/Transport Capacity -->
                        <StackPanel x:Name="CarrierCapacityPanel" Visibility="Collapsed" Margin="0,0,0,10">
                            <TextBlock x:Name="CarrierCapacityLabel" Text="Capacity:" Foreground="White" Margin="0,0,0,2"/>
                            <Grid Margin="0,0,0,5">
                                <ProgressBar x:Name="CarrierCapacityBar" Height="20" Minimum="0" Maximum="100"/>
                                <TextBlock x:Name="CarrierCapacityText" Text="0/0" HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold"/>
                            </Grid>
                            <ListBox x:Name="CarrierContentsList" Height="80"/>
                        </StackPanel>

                        <!-- Special Unit Warnings/Info -->
                        <TextBlock x:Name="PatrolBoatWarningText" Visibility="Collapsed" Foreground="Orange" TextWrapping="Wrap" Margin="0,0,0,5"/>
                        <TextBlock x:Name="ArtilleryRangeText" Visibility="Collapsed" Foreground="Yellow" TextWrapping="Wrap" Margin="0,0,0,5"/>
                        <TextBlock x:Name="AntiAircraftProximityText" Visibility="Collapsed" Foreground="LightBlue" TextWrapping="Wrap" Margin="0,0,0,5"/>
                        <TextBlock x:Name="SpyStatusText" Visibility="Collapsed" Foreground="Magenta" TextWrapping="Wrap" Margin="0,0,0,5"/>
                        <TextBlock x:Name="SapperBuildText" Visibility="Collapsed" Foreground="Cyan" TextWrapping="Wrap" Margin="0,0,0,5" FontWeight="Bold"/>

                        <!-- Unit Commands -->
                        <WrapPanel Margin="0,10,0,0">
                            <Button x:Name="MoveButton" Content="Move" Width="70" Margin="2" Click="MoveButton_Click"/>
                            <Button x:Name="PatrolButton" Content="Patrol" Width="70" Margin="2" Click="PatrolButton_Click"/>
                            <Button x:Name="AttackButton" Content="Attack" Width="70" Margin="2" Click="AttackButton_Click"/>
                            <Button x:Name="SkipTurnButton" Content="Skip" Width="70" Margin="2" Click="SkipTurnButton_Click"/>
                            <Button x:Name="SleepButton" Content="Sleep" Width="70" Margin="2" Click="SleepButton_Click"/>
                            <Button x:Name="SentryButton" Content="Sentry" Width="70" Margin="2" Click="SentryButton_Click"/>
                            <Button x:Name="WakeUpButton" Content="Wake Up" Width="70" Margin="2" Click="WakeUpButton_Click" Visibility="Collapsed"/>
                            <Button x:Name="LandAtBaseButton" Content="Land" Width="70" Margin="2" Click="LandAtBaseButton_Click"/>
                            <Button x:Name="ReturnToBaseButton" Content="RTB" Width="70" Margin="2" Click="ReturnToBaseButton_Click"/>
                            <Button x:Name="BombingRunButton" Content="Bomb" Width="70" Margin="2" Click="BombingRunButton_Click"/>
                            <Button x:Name="ToggleSubmergeButton" Content="Submerge" Width="70" Margin="2" Click="ToggleSubmergeButton_Click"/>
                            <Button x:Name="BuildBaseButton" Content="Build Base" Width="80" Margin="2" Click="BuildBaseButton_Click" Visibility="Collapsed"/>
                            <Button x:Name="BuildBridgeButton" Content="Build Bridge" Width="80" Margin="2" Click="BuildBridgeButton_Click" Visibility="Collapsed"/>
                            <Button x:Name="CancelBuildButton" Content="Cancel Build" Width="80" Margin="2" Click="CancelBuildButton_Click" Visibility="Collapsed"/>
                        </WrapPanel>
                    </StackPanel>
                </Border>

                <!-- Structure Info Panel -->
                <Border x:Name="StructureInfoPanel" Visibility="Collapsed" Background="#1e2a3a" BorderBrush="#0f3460" BorderThickness="2" Padding="10" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock x:Name="StructureNameText" Text="Structure" FontSize="18" FontWeight="Bold" Foreground="White" Margin="0,0,0,5"/>
                        <TextBlock x:Name="StructureLifeText" Text="Life" Foreground="LightGray" Margin="0,0,0,5"/>
                        <TextBlock x:Name="DefenseBonusText" Text="Defense" Foreground="LightBlue" Margin="0,0,0,10"/>

                        <!-- Airport -->
                        <TextBlock Text="🛫 Airport" FontSize="14" FontWeight="Bold" Foreground="Cyan" Margin="0,0,0,5"/>
                        <TextBlock x:Name="AirportCapacityText" Text="Capacity: 0/6" Foreground="White" Margin="0,0,0,5"/>
                        <ListBox x:Name="AirportList" Height="100" Margin="0,0,0,5" SelectionChanged="AirportList_SelectionChanged"/>
                        <WrapPanel Margin="0,0,0,10">
                            <Button x:Name="TakeOffButton" Content="Take Off" Width="80" Margin="2" Click="TakeOffButton_Click"/>
                            <Button x:Name="RepairAircraftButton" Content="Repair" Width="80" Margin="2" Click="RepairAircraftButton_Click"/>
                        </WrapPanel>

                        <!-- Shipyard -->
                        <StackPanel x:Name="ShipyardLabel">
                            <TextBlock Text="⚓ Shipyard" FontSize="14" FontWeight="Bold" Foreground="DodgerBlue" Margin="0,0,0,5"/>
                            <TextBlock x:Name="ShipyardCapacityText" Text="Capacity: 0/3" Foreground="White" Margin="0,0,0,5"/>
                            <ListBox x:Name="ShipyardList" Height="80" Margin="0,0,0,5" SelectionChanged="ShipyardList_SelectionChanged"/>
                            <WrapPanel Margin="0,0,0,10">
                                <Button x:Name="LaunchShipButton" Content="Launch" Width="80" Margin="2" Click="LaunchShipButton_Click"/>
                                <Button x:Name="RepairShipButton" Content="Repair" Width="80" Margin="2" Click="RepairShipButton_Click"/>
                            </WrapPanel>
                        </StackPanel>

                        <!-- Motor Pool -->
                        <TextBlock Text="🚗 Motor Pool" FontSize="14" FontWeight="Bold" Foreground="Orange" Margin="0,0,0,5"/>
                        <ListBox x:Name="MotorPoolList" Height="80" Margin="0,0,0,5" SelectionChanged="MotorPoolList_SelectionChanged"/>
                        <Button x:Name="DeployMotorButton" Content="Deploy Unit" Margin="0,0,0,10" Click="DeployMotorButton_Click"/>

                        <!-- Barracks -->
                        <TextBlock Text="🪖 Barracks" FontSize="14" FontWeight="Bold" Foreground="LimeGreen" Margin="0,0,0,5"/>
                        <TextBlock x:Name="BarracksCapacityText" Text="Capacity: 0/10" Foreground="White" Margin="0,0,0,5"/>
                        <ListBox x:Name="BarracksList" Height="80" Margin="0,0,0,5" SelectionChanged="BarracksList_SelectionChanged"/>
                        <Button x:Name="DeployArmyButton" Content="Deploy Army" Margin="0,0,0,10" Click="DeployArmyButton_Click"/>

                        <!-- Production Queue -->
                        <TextBlock Text="⚙️ Production Queue" FontSize="14" FontWeight="Bold" Foreground="Yellow" Margin="0,10,0,5"/>
                        <ListBox x:Name="ProductionQueueList" Height="100" Margin="0,0,0,10"/>

                        <!-- Build Unit -->
                        <TextBlock Text="Build Unit:" Foreground="White" Margin="0,0,0,5"/>
                        <ComboBox x:Name="UnitTypesCombo" Margin="0,0,0,5"/>
                        <Button x:Name="BuildUnitButton" Content="Add to Queue" Click="BuildUnitButton_Click"/>
                    </StackPanel>
                </Border>

                <!-- Game Control Buttons -->
                <StackPanel Orientation="Vertical" Margin="0,20,0,0">
                    <!-- Next Unit Button -->
                    <Button x:Name="NextUnitButton" Content="Next Unit (Space)" Height="40" Margin="0,0,0,10" 
            Click="NextUnitButton_Click" 
            Background="#2a3a4a" BorderBrush="#3d5a6b" BorderThickness="2" 
            Foreground="White" FontWeight="Bold">
                        <Button.Effect>
                            <DropShadowEffect Color="Black" Direction="320" ShadowDepth="2" Opacity="0.5"/>
                        </Button.Effect>
                    </Button>

                    <!-- New Game Button -->
                    <Button x:Name="NewGameButton" Content="New Game" Height="40" Margin="0,0,0,20" Visibility="Collapsed" 
            Click="NewGameButton_Click"
            Background="#1a3a4a" BorderBrush="#2a5a6b" BorderThickness="2" 
            Foreground="White" FontWeight="Bold">
                        <Button.Effect>
                            <DropShadowEffect Color="Black" Direction="320" ShadowDepth="2" Opacity="0.5"/>
                        </Button.Effect>
                    </Button>

                    <!-- Spacer to push buttons to bottom -->
                    <Border Height="20"/>

                    <!-- End Turn and Surrender Buttons - Side by Side at Bottom -->
                    <Grid HorizontalAlignment="Center" Margin="0,20,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- End Turn Button - Circular with Icon -->
                        <Button Grid.Column="0" x:Name="EndTurnButton" Width="80" Height="80" 
                Click="EndTurnButton_Click" Background="Transparent" BorderBrush="Transparent">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Grid>
                                        <Ellipse Fill="#2a4a2a" Stroke="#3d6b3d" StrokeThickness="3">
                                            <Ellipse.Effect>
                                                <DropShadowEffect Color="Black" Direction="320" ShadowDepth="3" Opacity="0.5"/>
                                            </Ellipse.Effect>
                                        </Ellipse>
                                        <Ellipse x:Name="Highlight" Fill="Transparent" Opacity="0"/>
                                        <Image x:Name="EndTurnImage" Width="40" Height="40" 
                               Source="/Resources/fast-forward.png" 
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="Highlight" Property="Fill" Value="White"/>
                                            <Setter TargetName="Highlight" Property="Opacity" Value="0.2"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter TargetName="Highlight" Property="Fill" Value="White"/>
                                            <Setter TargetName="Highlight" Property="Opacity" Value="0.4"/>
                                        </Trigger>
                                        <Trigger Property="IsEnabled" Value="False">
                                            <Setter Property="Opacity" Value="0.5"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>

                        <!-- Surrender Button - Circular with Icon -->
                        <Button Grid.Column="2" x:Name="SurrenderButton" Width="80" Height="80" 
                Click="SurrenderButton_Click" Background="Transparent" BorderBrush="Transparent">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Grid>
                                        <Ellipse Fill="#4a1a1a" Stroke="#6b2a2a" StrokeThickness="3">
                                            <Ellipse.Effect>
                                                <DropShadowEffect Color="Black" Direction="320" ShadowDepth="3" Opacity="0.5"/>
                                            </Ellipse.Effect>
                                        </Ellipse>
                                        <Ellipse x:Name="Highlight" Fill="Transparent" Opacity="0"/>
                                        <Image Width="40" Height="40" 
                               Source="/Resources/white-flag.png" 
                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="Highlight" Property="Fill" Value="White"/>
                                            <Setter TargetName="Highlight" Property="Opacity" Value="0.2"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter TargetName="Highlight" Property="Fill" Value="White"/>
                                            <Setter TargetName="Highlight" Property="Opacity" Value="0.4"/>
                                        </Trigger>
                                        <Trigger Property="IsEnabled" Value="False">
                                            <Setter Property="Opacity" Value="0.5"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </Grid>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>